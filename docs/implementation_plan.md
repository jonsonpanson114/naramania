# 奈良県建築・入札情報収集アプリ 実装計画

## 目標
奈良県および県内主要自治体（奈良市、橿原市、生駒市など）のウェブサイトから、形式の異なる入札・建築情報を自動収集し、一元管理・閲覧できるWebアプリケーションを構築する。

## ユーザーレビューが必要な事項
> [!IMPORTANT]
> **対象自治体の範囲**
> 全市町村を最初から網羅するのはメンテナンスコストが過大になるため、まずは「奈良県」「奈良市」「橿原市」「生駒市」の4つをターゲットとします。これで問題ないでしょうか？

> [!WARNING]
> **スクレイピングの法的使用とマナー**
> サイトへの負荷を避けるため、更新頻度は「1日1回」程度に制限します。また、各自治体の利用規約に準拠する設計としますが、万が一アクセスブロック等が発生した場合は対象から外す可能性があります。

## 提案する変更内容

### アーキテクチャ構成
1.  **Frontend**: Next.js (React)
    *   高速な表示とモダンなUI/UXを実現。
    *   Tailwind CSSを使用し、「プレミアム」で視認性の高いデザイン（ダークモード対応、グラスモーフィズム推奨）。
2.  **Backend / Scraper**: Python or Node.js
    *   Puppeteer/Playwright: 動的なページ（JS必須のサイト）に対応。
    *   PDF Parsing: 入札情報の多くはPDFのため、PDFからテキストを抽出・構造化するロジックを実装。必要に応じてGemini APIのマルチモーダル機能を利用して非定型データを解析。
3.  **Database**: Supabase (PostgreSQL) または ローカルJSON（プロトタイプ段階）
    *   収集したデータを正規化（統一フォーマット化）して保存。
    *   正規化フィールド: `自治体名`, `案件名`, `種別（工事/委託/コンサル等 - ※土木・物品は除外）`, `公告日`, `入札日/期限`, `リンク`, `ステータス`。

### コンポーネント詳細

#### 1. スクレイパーモジュール (`/scrapers`)
各自治体の「方言（HTML構造の違い）」を通訳するモジュール群。
*   `nara_pref.ts`: 県庁サイトのテーブル構造を解析。
*   `nara_city.ts`: 電子入札システム等の検索結果を解析。
*   `common/pdf_parser.ts`: PDFリンク先の文書をテキスト化し、LLM等を用いて重要項目（日付、金額など）を抽出。

#### 2. データ正規化・保存
*   各サイトから取得したバラバラのデータを、共通のインターフェース `BiddingItem` に変換。
*   重複除外ロジック（同じ案件を何度も保存しない）。

#### 3. フロントエンド (`/app`)
*   **ダッシュボード**: 全自治体の最新情報を一覧表示。
    *   フィルタ機能：自治体別、種別（建築/コンサル/委託 - ※土木・物品は含めない）、キーワード検索。
    *   ソート機能：締切日順、新着順。
*   **詳細表示**: 元サイトへのリンク、および抽出した要約情報の表示。

## 検証計画

### 自動テスト
*   各スクレイパーが正しくタイトルと日付を取得できるか、モックHTMLを用いて単体テストを実行。

### 手動検証
*   実際にスクレイパーを稼働させ、4つのサイトから最新データが取得できているか確認。
*   PDFの中身が正しく「案件名」や「期限」として抽出されているかを目視確認。
